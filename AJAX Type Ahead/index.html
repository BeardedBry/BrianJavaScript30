<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ajax Type Ahead</title>
  <!-- <link rel="stylesheet" href="style.css"> -->
  <style>
  *{
    margin: 0;
    padding: 0;
}

main{
    /* border: 1px solid red; */
    margin-right: auto;
    margin-left: auto;
    width: 70%;
    padding-top: 30vh;
}

.search{
    /* border: 1px solid green; */
    width: 100%;
    text-align: center;
}

.search > input {
    /* Need to center in main area */
    text-align: center;
    font-size: 2.3rem;
    border: 4px double grey;
    width: 100%;
    max-width: 400px;
}
</style>
</head>
<body>
    <main>
        <form class="search">
            <input id="textArea">
        </form>
        <div id="results">
        </div>
    </main>
    <script>
        const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';
        let data;
        fetch(endpoint).then((d) => d.json()).then(newData => data = newData);

        const txt = document.getElementById('textArea');
        const results = document.getElementById('results');

        txt.addEventListener('input',(e)=>{
            let eRegex = new RegExp(`${e.target.value}`,'gi');
            let currentEntries = document.querySelectorAll('div > p');
            if(currentEntries.length > 0){
                console.log(currentEntries);
                currentEntries.forEach((item) => {
                    if (!item.innerText.match(eRegex)){
                        item.parentElement.removeChild(item);
                    }
                })
                // (e => !e.innerText.match(RegExp))
                // entriesToBeDeleted.forEach(item => '');

            } else{
                let displayData = data.filter((d) => {
                    return d.city.match(eRegex);
                })
                displayData.forEach(element => {
                let newP = document.createElement('P');
                newP.innerText = `${element.city}`;
                results.appendChild(newP);
            });
            }
          
        })
      
    </script>
  </body>
</html>